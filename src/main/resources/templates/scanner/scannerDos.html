<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head th:replace="fragments/head :: baseHead(~{::title}, ~{::link}, ~{::script})">
    <meta charset="UTF-8">
    <title>Scanner</title>
    <link rel="stylesheet" th:href="@{/css/scanner.css}">
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.0.0/dist/tf.min.js"></script>
    <script th:href="@{/js/scanner.js}"></script>
</head>
<body>

<header th:replace="fragments/header"></header>
<div class="container mt-5">
    <div class="row ">
        <div class="col-md-4 margin-auto text-center divcontenedorVideo">
            <div class="text-center"id="contenedorVideo"></div>
        </div>
        <div class="col-md-4 text-center ">
            <div class="col-md-12 ajuste">
                <button class="btn col-md-12 mt-5 mb-4 naranja-blanco" id="cambiaravideo"><span class="fas fa-arrow-circle-left"></span> Video en tiempo real</button>
            </div>
            <div class="col-md-12 ajuste">
                <button class="btn col-md-12 mt-5 mb-4 naranja-blanco"  id="cambiaraimagen">Adjunar imagen <span class="fas fa-arrow-circle-right"></span></button>
            </div>
        </div>
        <div id="avatarImage" class="col-md-4 margin-auto text-center ">
            <div class="col-md-12 text-center vertical-center"><img id="imagenn" class="bordes-adjun" src="data:image/jpeg;base64,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" width="374" height="234"></div>
        </div>
    </div>
</div>
    <div class="row mt-2 asd2 text-center">
        <div class="col-md-12 mt-2 mb-4 text-center">
            <span class="col-md-12 " id="result"></span>
        </div>
    </div>
    <div class="row asd">
            <div class="col-md-4 mb-2">
                <button class="btn col-md-12 verde-blanco" id="botonPredecir">Iniciar</button>
            </div>
            <div class="col-md-4 mb-2">
                <button class="btn col-md-12 verde-blanco" onclick="masInfo()" id="info">Mas Informaci√≥n</button>
            </div>
            <div class="col-md-4 mb-2">
                <button class="btn col-md-12 verde-blanco" id="mapita">Ver Mapa</button>
            </div>
    </div>
<input onchange="previewFile()" type="file" hidden name="avatarInput" id="avatarInput" />

<script th:inline="javascript">
    let video;
    let featureExtractor;
    let clasificador;
    let categorias;
    let cate
    function setup() {
        noCanvas();
        clasificador = ml5.imageClassifier('MobileNet',modelReady);
        clasificador = ml5.imageClassifier('https://cdn.jsdelivr.net/gh/Nicolasemanuelmorales/prueba/mvp1.json',modelReady);
        clasificador.predict(document.getElementById('imagenn'), function(err, results) {
            console.log(results);
        });
        configuraBotones();
    }
    function configuraBotones() {

        let botonPredecir = select('#botonPredecir');
        botonPredecir.mousePressed(function () {
            clasificador.train();
            clasificador.classify(muestraResultado);
        });
    }

    function muestraResultado(err, res) {
        clasificador.classify(muestraResultado);
        /*<![CDATA[*/
        var myVariable= /*[[${categorias}]]*/ 'value';
        /*]]>*/
        if (res[0].confidence > 0.75) {
            myVariable.forEach(function (value) {
                if (res[0].label == value.imagen){
                cate = value.categoria.nombre;
                select("#result").html(cate);
                }
            });
        }else{}
    }
    function modelReady() {
        //clasificador.load('https://cdn.jsdelivr.net/gh/Nicolasemanuelmorales/prueba/mvp1.json');
    }

    function masInfo() {
        if(cate == null)
        {
        }
        else
        {
            window.location.replace("masinfo/"+cate);
        }
    }
    $(document).ready(function () {
        var $avatarInput, $avatarImage;
        $(function () {
            $avatarInput = $('#avatarInput');
            $avatarImage = $('#avatarImage');
            $avatarImage.on('click', function () {
                $avatarInput.click();
            })
        })
    });

    function previewFile() {
        const preview = document.querySelector('#imagenn');
        const di = document.querySelector('#avatarInput');
        const file = document.querySelector('input[type=file]').files[0];
        const reader = new FileReader();

        reader.addEventListener("load", function () {
            // convert image file to base64 string
            preview.src = reader.result;
        }, false);

        if (file) {
            reader.readAsDataURL(file);
        }
    }
</script>
<footer class="page-footer font-small indigo mt-5" style="background:#3D3D3D;border-top: solid 0.0px darkorange;">
    <div class="container">
        <div class="row text-center d-flex justify-content-center pt-5 mb-3">
            <div class="col-md-2 mb-3 text-center">
                <h6 class="text-uppercase font-weight-bold">
                    <a href="#!"><span style="color: white!important;">HOME</span></a>
                </h6>
            </div>
            <div class="col-md-2 mb-3 text-center">
                <h6 class="text-uppercase font-weight-bold">
                    <a href="/"><span style="color: white!important;">TIENDA</span></a>
                </h6>
            </div>
            <div class="col-md-2 mb-3 text-center">
                <h6 class="text-uppercase font-weight-bold">
                    <a href="/scanner/scanner"><span style="color: white!important;">SCANNER</span></a>
                </h6>
            </div>
            <div class="col-md-2 mb-3 text-center">
                <h6 class="text-uppercase font-weight-bold">
                    <a href="#"><span style="color: white!important;">CALENDARIO</span></a>
                </h6>
            </div>
            <div class="col-md-2 mb-3 text-center">
                <h6 class="text-uppercase font-weight-bold">
                    <a href="#"><span style="color: white!important;">MAPA</span></a>
                </h6>
            </div>
        </div>
        <hr class="rgba-white-light" style="margin: 0 auto;">
        <div class="row d-flex text-center justify-content-center mb-md-0 mb-4">
            <div class="col-md-8 col-12 mt-5 text-center">
                <p style=" font-weight: 600;font-size: 16px; color: white!important;">LO √öNICO QUE NO PODEMOS RECICLAR ES EL TIEMPO QUE MALGASTAMOS.</p>
            </div>

        </div>
        <hr class="clearfix d-md-none rgba-white-light" style="margin: 10% 15% 5%;">


    </div>
    <div class=" text-center py-3" style="color: white!important;">¬© 2020 Copyright:
        RecyClud.com
    </div>
</footer>

    </body>
</html>
